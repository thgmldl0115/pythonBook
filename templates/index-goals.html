{% extends 'top-footer.html' %}
{% block content %}

<!-- Begin Page Content -->
<div class="container-fluid">

    <!-- Page Heading -->
    <h1 class="h3 mb-2 text-gray-800">Wish List</h1>
    <p class="mb-4">올해 {{ userNm }}님이 읽고 싶은 책들은?</p>

    <!-- DataTales Example -->
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">목표 리스트</h6>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>책 제목</th>
                            <th>작가</th>
                            <th>카테고리</th>
                            <th>메모</th>
                            <th>총 페이지</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>책과 우연들</td>
                            <td>김초엽</td>
                            <td>문학</td>
                            <td>에세이</td>
                            <td>294</td>
                        </tr>
                    </tbody>
                </table>

            </div>
        </div>
    </div>

    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">목표 도서 추가</h6>
        </div>
        <div class="card-body">
            <form action="/findbook" method="post">
                <div class="mb-3">
                    <label class="form-label" for="searchBook">책 검색</label>
                    <div class="row">
                        <div class="col-8">
                            <input class="form-control" type="text" id="searchBook" name="searchBook">
                        </div>
                        <div class="col-4">
                            <button type="submit" class="btn btn-primary btn-user btn-block" id="searchBtn">
                                검색
                            </button>
                        </div>
                    </div>
                    &nbsp;

                    <div id="search-list">

                    </div>

                </div>

            </form>

            <button type="button" class="btn btn-primary btn-user btn-block">
                목표 도서 추가하기
            </button>

        </div>
    </div>

</div>
<!-- /.container-fluid -->
<script>
    $(document).ready(function(){
            console.log({{ idx }});
            if ({{idx}}==1){
                if (Object.keys({{ booklists|tojson  }}).length > 0){
                    var booklists = {{ booklists|tojson }};
                    fn_getList(booklists);
                }
            }


    });
    function fn_getList(books){
        $("#search-list").empty();
        let str = "";
        for(const book of books){
            str += '<div class="form-check">';
            str += '<input class="form-check-input" type="radio" name="goal-book" id="'+ book['isbn']+'">';
            str += '<label class="form-check-label" for="'+ book['isbn'] +'">';
            str +=  book['title'] + ', (' + book['author'].replaceAll('^', ', ') + ')';
            str += '<div style="margin:1rem;">';
            str += '<img src="' + book['image'] + '" style="width: 30%;"></div>';
            str += '</div>';
            str += '</label>';
            str += '<hr>';
        }
        $("#search-list").append(str);
    }
</script>

{% endblock %}